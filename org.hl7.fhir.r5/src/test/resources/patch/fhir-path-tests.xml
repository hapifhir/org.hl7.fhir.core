<tests>
  <case name="No Difference" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	    <birthDate value="1920-01-01"/>
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	    <birthDate value="1920-01-01"/>
	  </Patient>
	</output>
  </case>
  
  <case name="Replace Primitive" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	    <birthDate value="1920-01-01"/>
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="replace"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient.birthDate"/>
		  </part>
		  <part>
		    <name value="value"/>
			<valueDate value="1930-01-01"/>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	    <birthDate value="1930-01-01"/>
	  </Patient>
	</output>
  </case>

  <case name="Delete Primitive" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	    <birthDate value="1920-01-01"/>
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="delete"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient.birthDate"/>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	  </Patient>
	</output>
  </case>

  <case name="Add Primitive" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="add"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient"/>
		  </part>
		  <part>
		    <name value="name"/>
			<valueString value="birthDate"/>
		  </part>
		  <part>
		    <name value="value"/>
			<valueDate value="1930-01-01"/>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	    <birthDate value="1930-01-01"/>
	  </Patient>
	</output>
  </case>
  
  <case name="Delete Primitive #2" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	    <birthDate value="1920-01-01"/>
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="delete"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient.birthDate"/>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	  </Patient>
	</output>
  </case>

  <!-- same operations, on a nested primitive -->
  <case name="Replace Nested Primitive #1" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	    <contact>
		  <name>
		    <text value="a name"/>
		  </name>
	      <gender value="male"/>
		</contact>
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="replace"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient.contact[0].gender"/>
		  </part>
		  <part>
		    <name value="value"/>
			<valueCode value="female"/>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	    <contact>
		  <name>
		    <text value="a name"/>
		  </name>
	      <gender value="female"/>
		</contact>
	  </Patient>
	</output>
  </case>

  <case name="Replace Nested Primitive #2" mode="both"> 
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	    <contact>
		  <name>
		    <text value="a name"/>
		  </name>
	      <gender value="male"/>
		</contact>
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="replace"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient.contact[0].name.text"/>
		  </part>
		  <part>
		    <name value="value"/>
			<valueString value="the name"/>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	    <contact>
		  <name>
		    <text value="the name"/>
		  </name>
	      <gender value="male"/>
		</contact>
	  </Patient>
	</output>
  </case>

  <case name="Delete Nested Primitive #1" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	    <contact>
		    <name>
		      <text value="a name"/>
		    </name>
	      <gender value="male"/>
		</contact>
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="delete"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient.contact[0].gender"/>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	    <contact>
		  <name>
		    <text value="a name"/>
		  </name>
		</contact>
	  </Patient>
	</output>
  </case>

  <case name="Delete Nested Primitive #2" mode="forwards"><!-- because skip level -->
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	    <contact>
		  <name>
		    <text value="a name"/>
		  </name>
	      <gender value="male"/>
		</contact>
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="delete"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient.contact[0].name.text"/>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	    <contact>
	      <gender value="male"/>
		</contact>
	  </Patient>
	</output>
  </case>

  <case name="Add Nested Primitive" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	    <contact>
		  <name>
		    <text value="a name"/>
		  </name>
		</contact>
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="add"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient.contact[0]"/>
		  </part>
		  <part>
		    <name value="name"/>
			<valueString value="gender"/>
		  </part>
		  <part>
		    <name value="value"/>
			<valueCode value="male"/>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	    <contact>
		  <name>
		    <text value="a name"/>
		  </name>
	      <gender value="male"/>
		</contact>
	  </Patient>
	</output>
  </case>
  
  <!-- moving on to operations on a complex -->
  <case name="Add Complex" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="add"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient"/>
		  </part>
		  <part>
		    <name value="name"/>
			<valueString value="maritalStatus"/>
		  </part>
		  <part>
		    <name value="value"/>
			<valueCodeableConcept>
			  <text value="married"/>
			</valueCodeableConcept>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	    <maritalStatus>
		  <text value="married"/>
		</maritalStatus>
	  </Patient>
	</output>
  </case>

  <case name="Replace Complex" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	    <maritalStatus id="1">
		  <text value="married"/>
		</maritalStatus>
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="replace"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient.maritalStatus"/>
		  </part>
		  <part>
		    <name value="value"/>
			<valueCodeableConcept id="2">
			  <text value="not married"/>
			</valueCodeableConcept>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	    <maritalStatus id="2">
		  <text value="not married"/>
		</maritalStatus>
	  </Patient>
	</output>
  </case>

  <case name="Delete Complex" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	    <maritalStatus>
		  <text value="married"/>
		</maritalStatus>
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="delete"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient.maritalStatus"/>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	  </Patient>
	</output>
  </case>

  <!-- anonymous type -->
  <case name="Add Anonymous Type" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="add"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient"/>
		  </part>
		  <part>
		    <name value="name"/>
			<valueString value="contact"/>
		  </part>
		  <part>
		    <name value="value"/>
			<part>
			  <name value="name"/>
			  <valueHumanName>
  		        <text value="a name"/>
			  </valueHumanName>
			</part>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	    <contact>
		  <name>
		    <text value="a name"/>
		  </name>
		</contact>
	  </Patient>
	</output>
  </case>
  
  <case name="Delete Anonymous Type" mode="both">
    <input> 
	  <Patient xmlns="http://hl7.org/fhir">
	    <contact>
		  <name>
		    <text value="a name"/>
		  </name>
		</contact>
	  </Patient>
	</input>
	<diff>
	  <Parameters xmlns="http://hl7.org/fhir">
	    <parameter>
		  <name value="operation"/>
		  <part>
		    <name value="type"/>
			<valueCode value="delete"/>
		  </part>
		  <part>
		    <name value="path"/>
			<valueString value="Patient.contact[0]"/>
		  </part>
		</parameter>
	  </Parameters>	  
	</diff>
	<output>
	  <Patient xmlns="http://hl7.org/fhir">
	  </Patient>
	</output>
  </case>
  
  
  <!-- lists -->
  <case name="List unchanged" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
      </Parameters>	  
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
      </Patient>
    </output>
  </case>
  
  <case name="List unchanged, contents changed" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier id="a">
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier id="b">
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
        <name value="operation"/>
        <part>
          <name value="type"/>
          <valueCode value="replace"/>
        </part>
        <part>
          <name value="path"/>
          <valueString value="Patient.identifier[0].value"/>
        </part>
        <part>
          <name value="value"/>
          <valueString value="value 2"/>
        </part>
        </parameter>
        <parameter>
        <name value="operation"/>
        <part>
          <name value="type"/>
          <valueCode value="replace"/>
        </part>
        <part>
          <name value="path"/>
          <valueString value="Patient.identifier[1].value"/>
        </part>
        <part>
          <name value="value"/>
          <valueString value="value 1"/>
        </part>
        </parameter>
      </Parameters>	  
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier id="a">
        <system value="http://example.org"/>
        <value value="value 2"/>
      </identifier>
      <identifier id="b">
        <system value="http://example.org"/>
        <value value="value 1"/>
      </identifier>
      </Patient>
    </output>
  </case>

  <case name="Add to list" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="insert"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier"/>
          </part>
          <part>
            <name value="index"/>
            <valueInteger value="2"/>
          </part>
          <part>
            <name value="value"/>
            <valueIdentifier>
              <system value="http://example.org"/>
              <value value="value 3"/>
            </valueIdentifier>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
      </Patient>
    </output>
  </case>
  
  <case name="Insert in list #1" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="insert"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier"/>
          </part>
          <part>
            <name value="index"/>
            <valueInteger value="1"/>
          </part>
          <part>
            <name value="value"/>
            <valueIdentifier>
              <system value="http://example.org"/>
              <value value="value 3"/>
            </valueIdentifier>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
      </Patient>
    </output>
  </case>
  
  <case name="Insert in list #2" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="insert"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier"/>
          </part>
          <part>
            <name value="index"/>
            <valueInteger value="0"/>
          </part>
          <part>
            <name value="value"/>
            <valueIdentifier>
              <system value="http://example.org"/>
              <value value="value 3"/>
            </valueIdentifier>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
      </Patient>
    </output>
  </case>
  
  <case name="Delete from List #1" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="delete"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier[0]"/>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
      </Patient>
    </output>
  </case>
  
  <case name="Delete from List #2" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="delete"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier[1]"/>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
      </Patient>
    </output>
  </case>
  
  <case name="Delete from List #3" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="delete"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier[2]"/>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
      </Patient>
    </output>
  </case>
  
  <case name="Reorder List #1" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 4"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="move"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier"/>
          </part>
          <part>
            <name value="source"/>
            <valueInteger value="3"/>
          </part>
          <part>
            <name value="destination"/>
            <valueInteger value="1"/>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 4"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
      </Patient>
    </output>
  </case>
  
  <case name="Reorder List #2" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 4"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="move"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier"/>
          </part>
          <part>
            <name value="source"/>
            <valueInteger value="3"/>
          </part>
          <part>
            <name value="destination"/>
            <valueInteger value="0"/>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 4"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
      </Patient>
    </output>
  </case>
  
  <case name="Reorder List #3" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 4"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="move"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier"/>
          </part>
          <part>
            <name value="source"/>
            <valueInteger value="3"/>
          </part>
          <part>
            <name value="destination"/>
            <valueInteger value="2"/>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 4"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
      </Patient>
    </output>
  </case>

  <case name="Reorder List #4" mode="forwards">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 4"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="move"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier"/>
          </part>
          <part>
            <name value="source"/>
            <valueInteger value="0"/>
          </part>
          <part>
            <name value="destination"/>
            <valueInteger value="3"/>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 4"/>
        </identifier>
      </Patient>
    </output>
  </case>

  <case name="Reorder List #5" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 4"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="move"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier"/>
          </part>
          <part>
            <name value="source"/>
            <valueInteger value="1"/>
          </part>
          <part>
            <name value="destination"/>
            <valueInteger value="0"/>
          </part>
        </parameter>
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="move"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier"/>
          </part>
          <part>
            <name value="source"/>
            <valueInteger value="2"/>
          </part>
          <part>
            <name value="destination"/>
            <valueInteger value="1"/>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 4"/>
        </identifier>
      </Patient>
    </output>
  </case>

  <case name="Reorder List #6" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 4"/>
        </identifier>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="move"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier"/>
          </part>
          <part>
            <name value="source"/>
            <valueInteger value="3"/>
          </part>
          <part>
            <name value="destination"/>
            <valueInteger value="0"/>
          </part>
        </parameter>
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="move"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier"/>
          </part>
          <part>
            <name value="source"/>
            <valueInteger value="3"/>
          </part>
          <part>
            <name value="destination"/>
            <valueInteger value="1"/>
          </part>
        </parameter>
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="move"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.identifier"/>
          </part>
          <part>
            <name value="source"/>
            <valueInteger value="3"/>
          </part>
          <part>
            <name value="destination"/>
            <valueInteger value="2"/>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <identifier>
          <system value="http://example.org"/>
          <value value="value 4"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 3"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 2"/>
        </identifier>
        <identifier>
          <system value="http://example.org"/>
          <value value="value 1"/>
        </identifier>
      </Patient>
    </output>
  </case>

  <case name="Full Resource" mode="both">
    <input> 
      <Patient xmlns="http://hl7.org/fhir">
        <id value="example"/>
        <text>
          <status value="generated"/>
          <div xmlns="http://www.w3.org/1999/xhtml">
            
            <table>
              
              <tbody>
                
                <tr>
                  
                  <td>Name</td>
                  
                  <td>Peter James 
                    <b>Chalmers</b> (&quot;Jim&quot;)
                  </td>
                
                </tr>
                
                <tr>
                  
                  <td>Address</td>
                  
                  <td>534 Erewhon, Pleasantville, Vic, 3999</td>
                
                </tr>
                
                <tr>
                  
                  <td>Contacts</td>
                  
                  <td>Home: unknown. Work: (03) 5555 6473</td>
                
                </tr>
                
                <tr>
                  
                  <td>Id</td>
                  
                  <td>MRN: 12345 (Acme Healthcare)</td>
                
                </tr>
              
              </tbody>
            
            </table>    
          
          </div>
        </text>
      <!--   MRN assigned by ACME healthcare on 6-May 2001   -->
        <identifier>
          <use value="usual"/>
          <type>
            <coding>
              <system value="http://hl7.org/fhir/v2/0203"/>
              <code value="MR"/>
            </coding>
          </type>
          <system value="urn:oid:1.2.36.146.595.217.0.1"/>
          <value value="12345"/>
          <period>
            <start value="2001-05-06"/>
          </period>
          <assigner>
            <display value="Acme Healthcare"/>
          </assigner>
        </identifier>
        <active value="true"/>
      <!--   Peter James Chalmers, but called "Jim"   -->
        <name>
          <use value="official"/>
          <family value="Chalmers"/>
          <given value="Peter"/>
          <given value="James"/>
        </name>
        <name>
          <use value="usual"/>
          <given value="Jim"/>
        </name>
        <telecom>
          <use value="home"/>
        <!--   home communication details aren't known   -->
        </telecom>
        <telecom>
          <system value="phone"/>
          <value value="(03) 5555 6473"/>
          <use value="work"/>
        </telecom>
      <!--   use FHIR code system for male / female   -->
        <gender value="male"/>
        <birthDate value="1974-12-25">
          <extension url="http://hl7.org/fhir/StructureDefinition/patient-birthTime">
            <valueDateTime value="1974-12-25T14:35:45-05:00"/>
          </extension>
        </birthDate>
        <deceasedBoolean value="false"/>
        <address>
          <use value="home"/>
          <type value="both"/>
          <line value="534 Erewhon St"/>
          <city value="PleasantVille"/>
          <district value="Rainbow"/>
          <state value="Vic"/>
          <postalCode value="3999"/>
          <period>
            <start value="1974-12-25"/>
          </period>
        </address>
        <contact>
          <relationship>
            <coding>
              <system value="http://hl7.org/fhir/patient-contact-relationship"/>
              <code value="partner"/>
            </coding>
          </relationship>
          <name>
            <family value="du Marché">
            <!--   the "du" part is a family name prefix (VV in iso 21090)   -->
              <extension url="http://hl7.org/fhir/StructureDefinition/humanname-own-prefix">
                <valueString value="VV"/>
              </extension>
            </family>
            <given value="Bénédicte"/>
          </name>
          <telecom>
            <system value="phone"/>
            <value value="+33 (237) 998327"/>
          </telecom>
          <address>
            <use value="home"/>
            <type value="both"/>
            <line value="534 Erewhon St"/>
            <city value="PleasantVille"/>
            <district value="Rainbow"/>
            <state value="Vic"/>
            <postalCode value="3999"/>
            <period>
              <start value="1974-12-25"/>
            </period>
          </address>
          <gender value="female"/>
          <period>
          <!--   The contact relationship started in 2012   -->
            <start value="2012"/>
          </period>
        </contact>
        <managingOrganization>
          <reference value="Organization/1"/>
        </managingOrganization>
      </Patient>
    </input>
    <diff>
      <Parameters xmlns="http://hl7.org/fhir">
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="replace"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.text.div"/>
          </part>
          <part>
            <name value="value"/>
            <valueString value="&lt;div xmlns=&quot;http://www.w3.org/1999/xhtml&quot;>&#10;            &#10;            &lt;table>&#10;              &#10;              &lt;tbody>&#10;                &#10;                &lt;tr>&#10;                  &#10;                  &lt;td>Name&lt;/td>&#10;                  &#10;                  &lt;td>Peter James &#10;                    &lt;b>Chalmers1&lt;/b> (&quot;Jim&quot;)&#10;                  &lt;/td>&#10;                &#10;                &lt;/tr>&#10;                &#10;                &lt;tr>&#10;                  &#10;                  &lt;td>Address&lt;/td>&#10;                  &#10;                  &lt;td>534 Erewhon, Pleasantville, Vic, 3999&lt;/td>&#10;                &#10;                &lt;/tr>&#10;                &#10;                &lt;tr>&#10;                  &#10;                  &lt;td>Contacts&lt;/td>&#10;                  &#10;                  &lt;td>Home: unknown. Work: (03) 5555 6473&lt;/td>&#10;                &#10;                &lt;/tr>&#10;                &#10;                &lt;tr>&#10;                  &#10;                  &lt;td>Id&lt;/td>&#10;                  &#10;                  &lt;td>MRN: 12345 (Acme Healthcare)&lt;/td>&#10;                &#10;                &lt;/tr>&#10;              &#10;              &lt;/tbody>&#10;            &#10;            &lt;/table>    &#10;          &#10;          &lt;/div>"/>
          </part>
        </parameter>
        <parameter>
          <name value="operation"/>
          <part>
            <name value="type"/>
            <valueCode value="replace"/>
          </part>
          <part>
            <name value="path"/>
            <valueString value="Patient.name[0].family"/>
          </part>
          <part>
            <name value="value"/>
            <valueString value="Chalmers1"/>
          </part>
        </parameter>
      </Parameters>    
    </diff>
    <output>
      <Patient xmlns="http://hl7.org/fhir">
        <id value="example"/>
        <text>
          <status value="generated"/>
          <div xmlns="http://www.w3.org/1999/xhtml">
            
            <table>
              
              <tbody>
                
                <tr>
                  
                  <td>Name</td>
                  
                  <td>Peter James 
                    <b>Chalmers1</b> (&quot;Jim&quot;)
                  </td>
                
                </tr>
                
                <tr>
                  
                  <td>Address</td>
                  
                  <td>534 Erewhon, Pleasantville, Vic, 3999</td>
                
                </tr>
                
                <tr>
                  
                  <td>Contacts</td>
                  
                  <td>Home: unknown. Work: (03) 5555 6473</td>
                
                </tr>
                
                <tr>
                  
                  <td>Id</td>
                  
                  <td>MRN: 12345 (Acme Healthcare)</td>
                
                </tr>
              
              </tbody>
            
            </table>    
          
          </div>
        </text>
      <!--   MRN assigned by ACME healthcare on 6-May 2001   -->
        <identifier>
          <use value="usual"/>
          <type>
            <coding>
              <system value="http://hl7.org/fhir/v2/0203"/>
              <code value="MR"/>
            </coding>
          </type>
          <system value="urn:oid:1.2.36.146.595.217.0.1"/>
          <value value="12345"/>
          <period>
            <start value="2001-05-06"/>
          </period>
          <assigner>
            <display value="Acme Healthcare"/>
          </assigner>
        </identifier>
        <active value="true"/>
      <!--   Peter James Chalmers, but called "Jim"   -->
        <name>
          <use value="official"/>
          <family value="Chalmers1"/>
          <given value="Peter"/>
          <given value="James"/>
        </name>
        <name>
          <use value="usual"/>
          <given value="Jim"/>
        </name>
        <telecom>
          <use value="home"/>
        <!--   home communication details aren't known   -->
        </telecom>
        <telecom>
          <system value="phone"/>
          <value value="(03) 5555 6473"/>
          <use value="work"/>
        </telecom>
      <!--   use FHIR code system for male / female   -->
        <gender value="male"/>
        <birthDate value="1974-12-25">
          <extension url="http://hl7.org/fhir/StructureDefinition/patient-birthTime">
            <valueDateTime value="1974-12-25T14:35:45-05:00"/>
          </extension>
        </birthDate>
        <deceasedBoolean value="false"/>
        <address>
          <use value="home"/>
          <type value="both"/>
          <line value="534 Erewhon St"/>
          <city value="PleasantVille"/>
          <district value="Rainbow"/>
          <state value="Vic"/>
          <postalCode value="3999"/>
          <period>
            <start value="1974-12-25"/>
          </period>
        </address>
        <contact>
          <relationship>
            <coding>
              <system value="http://hl7.org/fhir/patient-contact-relationship"/>
              <code value="partner"/>
            </coding>
          </relationship>
          <name>
            <family value="du Marché">
            <!--   the "du" part is a family name prefix (VV in iso 21090)   -->
              <extension url="http://hl7.org/fhir/StructureDefinition/humanname-own-prefix">
                <valueString value="VV"/>
              </extension>
            </family>
            <given value="Bénédicte"/>
          </name>
          <telecom>
            <system value="phone"/>
            <value value="+33 (237) 998327"/>
          </telecom>
          <address>
            <use value="home"/>
            <type value="both"/>
            <line value="534 Erewhon St"/>
            <city value="PleasantVille"/>
            <district value="Rainbow"/>
            <state value="Vic"/>
            <postalCode value="3999"/>
            <period>
              <start value="1974-12-25"/>
            </period>
          </address>
          <gender value="female"/>
          <period>
          <!--   The contact relationship started in 2012   -->
            <start value="2012"/>
          </period>
        </contact>
        <managingOrganization>
          <reference value="Organization/1"/>
        </managingOrganization>
      </Patient>
    </output>
  </case>  
</tests>